#!/bin/bash

# ะกะบัะธะฟั ะดะปั ัะฒะธะดะบะพะณะพ ะทะฐะฟััะบั ะทะฐััะพััะฝะบั

echo "๐ ะะฐะฟััะบ REST API ะฒะตะฑ-ะทะฐััะพััะฝะบั..."
echo ""

# ะะตัะตะฒััะบะฐ ัะธ ััะฝัั ะฒััััะฐะปัะฝะต ัะตัะตะดะพะฒะธัะต
if [ ! -d "venv" ]; then
    echo "โ ะััััะฐะปัะฝะต ัะตัะตะดะพะฒะธัะต ะฝะต ะทะฝะฐะนะดะตะฝะพ!"
    echo "ะกัะฒะพัััะผะพ ะฒััััะฐะปัะฝะต ัะตัะตะดะพะฒะธัะต..."
    python3 -m venv venv
    echo "โ ะััััะฐะปัะฝะต ัะตัะตะดะพะฒะธัะต ััะฒะพัะตะฝะพ"
    echo ""
fi

# ะะบัะธะฒะฐััั ะฒััััะฐะปัะฝะพะณะพ ัะตัะตะดะพะฒะธัะฐ
echo "๐ง ะะบัะธะฒะฐััั ะฒััััะฐะปัะฝะพะณะพ ัะตัะตะดะพะฒะธัะฐ..."
source venv/bin/activate

# ะะตัะตะฒััะบะฐ ัะธ ะฒััะฐะฝะพะฒะปะตะฝั ะทะฐะปะตะถะฝะพััั
if ! python -c "import flask" 2>/dev/null; then
    echo "๐ฆ ะััะฐะฝะพะฒะปะตะฝะฝั ะทะฐะปะตะถะฝะพััะตะน..."
    pip install -r requirements.txt
    echo "โ ะะฐะปะตะถะฝะพััั ะฒััะฐะฝะพะฒะปะตะฝะพ"
    echo ""
fi

# ะะตัะตะฒััะบะฐ ัะธ ััะฝัั ะฑะฐะทะฐ ะดะฐะฝะธั
if [ ! -f "app.db" ]; then
    echo "๐๏ธ ะะฐะทะฐ ะดะฐะฝะธั ะฝะต ะทะฝะฐะนะดะตะฝะฐ. ะะฝัััะฐะปัะทะฐััั..."
    flask --app run init-db
    echo ""
fi

echo "โ ะัะต ะณะพัะพะฒะพ!"
echo ""
echo "๐ ะะฐััะพััะฝะพะบ ะฑัะดะต ะดะพัััะฟะฝะธะน ะทะฐ ะฐะดัะตัะพั: http://localhost:5000"
echo ""
echo "๐ค ะขะตััะพะฒั ะพะฑะปัะบะพะฒั ะทะฐะฟะธัะธ:"
echo "   ะะดะผัะฝััััะฐัะพั: admin / admin123"
echo "   ะะพัะธัััะฒะฐั: user / user123"
echo ""
echo "โน๏ธ  ะะปั ะทัะฟะธะฝะบะธ ะฝะฐัะธัะฝััั Ctrl+C"
echo ""
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# ะะฐะฟััะบ ะทะฐััะพััะฝะบั
python run.py




